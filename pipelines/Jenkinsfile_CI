Map props = [
    "DOCKER_IMAGE" : "mariuszdolata/jdk12:0.1"
]

pipeline {
    agent any
    stages {
        stage('Checkout Repository') {
            steps {
                echo 'Checkout Repository'
                script {
                    sh 'rm -rf' //clean workspace
                    git branch: 'master', credentialsId: 'github', url: 'https://github.com/mariuszdolata/testRepo.git'
                }
            }
         }
    }

            stage('Compile'){
                agent {
                 docker{
                            image 'mariuszdolata/jdk12:0.1'
                            args '-v $HOME/.m2:/root/.m2'
                        }
                }
                steps {
                    script {
                        echo "Compile process inside docker container"

                            sh 'mvn compile'

                    }
                }
            }

            stage('Unit tests'){
            agent {
             docker{
                        image 'mariuszdolata/jdk12:0.1'
                        args '-v $HOME/.m2:/root/.m2'
                    }
            }
                steps {
                    script {
                        echo "unit tests execution inside docker container"

                            sh 'mvn test'

                    }
                }
            }


}